<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="house">
	<!-- 하우스등록 -->
  <insert id="insertHouse" parameterType="h">
  insert into house
  values(house_seq.nextval,#{memberNo},#{houseTitle},#{houseownerDeadline},2,null,#{houseContent},#{houseRoom},#{houseCharge},
  #{houseRule},#{houseForm},#{houseGender},#{houseConvenience},1)
  	<selectKey resultType="_int" order="AFTER" keyProperty="houseNo">
  	<!-- 하우스 번호 넘기기위한 selectkey 발동 -->
  		select max(house_no) from house
  	</selectKey>
  </insert>
  <!-- 하우스 등록할때 주소등록 -->
  <insert id="insertAddress" parameterType="addr">
  	insert into address 
  	values(address_seq.nextval,#{addressNumber},#{addressCode},#{addressName},#{addressRoad},#{addressLegal},1,#{addressDetail})
  </insert>
  <!-- 하우스 등록할때 계좌등록 -->
  <insert id="insertIncome" parameterType="i">
  	insert into income
  	values(income_seq.nextval,#{incomeBank},#{incomeAccount},#{incomeName},2,#{incomeNum})
  </insert>
  
  <!-- 하우스 리스트 출력 - sowon 
  <select id="selectSearchHouse" parameterType="search">
  		select * from house 
  				<trim prefix="where" prefixOverrides="and|or">
  					<if test="!gender.equals('')">
  						house_gender=#{gender}
  					</if>
  					<if test="!housetype.equals('')">
  						house_Form=#{housetype}
  					</if>
  				</trim>
			    where house_gender=#{gender}
			    and house_Form=#{housetype}
			    and ((house_title || house_content || HOUSE_FORM) like=%#{keyword}%)    
			    or house_no = (select address_number from address where ADDRESS_CATEGORY='1' and (address_name || address_road || address_legal) like=%#{keyword}%);
			   <if test="">			   
			    	and house_no in (select house_no from room where ROOM_PERSONNEL=#{room} and ROOM_CHARGE between #{roomCharge1} and #{roomCharge2})
			   </if>
  </select>
  -->
</mapper>
